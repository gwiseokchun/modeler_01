<!DOCTYPE html>
<html lang="ko">

<head>
  <title>MODEL LIST</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <style type="text/css">
    @import url(//fonts.googleapis.com/earlyaccess/notosanskr.css);

    body , html
    {
      font-family: "Noto Sans KR", sans-serif !important;
      font-weight: normal;
      font-style: normal;
      height: 100%;
      padding: 0;
      margin: 0;
    }

  .active {
    text-decoration: underline;
  }

  .section , aside{
        float:left;
        height:300px;
        margin-top: -1px;
  }

  aside {
        width:400px;
        background:hsl(0 0% 97% / 1);
  }

  .collaborator{
  
    height: 100%;
    background-color: white;
    border-left: 1px solid hsl(0 0% 87% / 1); 
    box-shadow: rgba(0, 0, 0, 0.1) -3px 0px 5px -4px;
  }

  .collaborator_header{
    margin: 0px;
    padding: 20px;
    color: hsl(0 0% 33% / 1); 
    background-color: hsl(0 0% 97% / 1); 
    font-size: 14px;
    border-bottom: 1px solid hsl(0 0% 87% / 1); ;
    border-top: 1px solid hsl(0 0% 87% / 1); 
  }

  .btn-none{
    display: flex;
    -webkit-box-align: center;
    align-items: center;
    background-color: transparent;
    border: none;
    padding: 0px;
    margin: 0px;
    cursor: pointer;
    outline: none;
    padding: 0px 10px;
    display: flex;
    color: rgba(0, 0, 0, 0.4);
    flex: 2 1 0%;
  }


#Progress_Loading
{
 position: absolute;
 left: 50%;
 top: 50%;
 background: #ffffff;
}

td 
{
  box-shadow : 0px 2px  rgba(0, 0, 0, 0.1);
}

</style>


</head>

<body>
<!-- 로딩바 -->
<div id = "Progress_Loading">
  <img src="/Progress_Loading.gif"/>
</div>

<!-- Popup Layer -->

<div id="delete_layer" style="display: none;">
  <div style="height: 50px; 
              padding-top: 10px;
              padding-bottom: 20px;
  ">
    <button style="border: 1px solid hsl(0 0% 87% / 1); 
                               padding-right: 20px; 
                               padding-left: 20px; ">
    삭제                             
    </button>
  </div>
</div>

   <div style="height: 50px; 
            padding-top: 10px;
            padding-bottom: 20px;
  ">
  <img src="/logo.png" style="border-right: 1px solid hsl(0 0% 87% / 1); 
                               padding-right: 20px; 
                               padding-left: 20px; 
  ">
  <a href="/home2" style="padding-left: 20px; color: hsl(0 0% 50% / 1);">HOME</a>
  <a href="/home/1" style="padding-left: 20px; color: hsl(0 0% 50% / 1);">MODEL LIST</a>
  <a href="/modeler" style="padding-left: 20px; color: hsl(0 0% 50% / 1);">MODELER</a>
  <a href="/history/1" style="padding-left: 20px; color: hsl(0 0% 50% / 1);">HISTORY</a>
  <% if(sess) { %>
  <a href="/logout" style="padding-left: 20px; 
                           position: absolute; 
                           right: 50px; 
                           top : 17px; 
                           color: hsl(0 0% 50% / 1);">
                           LOGOUT</a>
  <% } %>
</div>

<div  style="background-color: hsl(0,0%,97%); 
            padding: 25px 100px; 
            position: relative; 
            height: 10%;
            border-bottom: 1px solid hsl(0 0% 87% / 1);
            border-top: 1px solid hsl(0 0% 87% / 1);
            margin-top: 10px;
            font-size: 19px;
            ">
  Welcome, <%=sess%> 님
</div>

  <div class="section"style="padding-left: 100px; 
                             background-color: hsl(0,0%,97%); 
                             height: 100%">
    <br>
    <br>
    <br>
    <br>

    <table class="table table-striped" 
            style="width: 1400px;">
     <thead>
      <tr>
        <th style="width: 20%">모델 ID</th>
        <th style="width: 15%">프로세스 ID</th>
        <th style="width: 15%">모델 이름</th>
        <th style="width: 35%">모델 세부사항</th>
        <th style="width: 5%">열기</th>
        <th style="width: 5%">수정</th>
        <th style="width: 5%">삭제</th>
      </tr>
    </thead>

    <tbody>
     
      <% for(var i = (page * page_num) - page_num; i < (page * page_num); i++) {  %>
      <%      if(i > length){
                i++;
              }
              else{  var rows = data[i]; %>
      
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
<!-- border-radius: 3px;
     border: 1px solid hsl(0 0% 87% / 1);
     box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 4px 0px;-->
      <tr style="background-color: #ffffff; border: 1px solid hsl(0 0% 87% / 1);">
        <td><%= rows.MODELID  %></td>
        <td><%= rows.PROCESSID  %></td>
        <td><%= rows.MODELNAME %></td>
        <td><%= rows.MODELDESC %></td>
        <td><a href="/viewer?id=<%= rows.MODELID %>">열기</a></td>
        <td><a href="/modeler?id=<%= rows.MODELID %>">수정</a></td>
        <td><a href="/delete?id=<%= rows.MODELID %>">삭제</a></td>        
      </tr>
    <% } %>
    <% } %>

    <tr>
        <td colspan="7" align="center" style="background-color: white">
            <% for(var j = 0; j < (length + 1) / page_num; j++){ %>
            [<a href="/home/<%= j + 1 %>"><%= j + 1 %></a>]
            <%}%>
        </td>
    </tr>
  </tbody>
</table>
</div>

<!-- Colaboratin -->
<aside  style="height: 100%">
  <div class="collaborator">
    <h3 id="collaborator-sidebar-title" class="collaborator_header">공유</h3>

    <div style="display: flex;
                -webkit-box-pack: end;
                justify-content: flex-end;
                margin-bottom: 15px;
                margin-top: 15px;
    ">
        <button id="btn_user" class="btn btn-primary" style="width: 80px;">추가</button>
    </div>
    <div style="display: flex;
                -webkit-box-align: center;
                align-items: center;
                padding-left: 50px;
                padding-bottom: 10px;">
      <button class="btn-none">이름</button>
      <button class="btn-none">역할</button>
    </div>

    <ul id="user-list"
        data-test="entity-list" style="margin: 3px 0px 15px;
                                       padding-left: 0px;
                                       list-style-type: none;
                                       width: 100%;">
      <li data-test="entity-You" style="border-top: 1px solid hsl(0 0% 87% / 1);
                                        padding-top: 10px;
                                        display: flex;
                                        -webkit-box-pack: justify;
                                        justify-content: space-between;
                                        background-color: white;
                                        -webkit-box-align: center;
                                        align-items: center;
                                        color: var(--grey-lighten-50);
                                        border-bottom: 1px solid hsl(0 0% 87% / 1);
                                        margin-bottom: 10px;
                                        padding-bottom: 10px;
                                        ">
        <span style="padding-left: 50px;"><%=sess%></span>
        <span>소유</span>
        <span></span>
        </li>
      </ul>
  </div>
</aside>



<br>
<br>
<br>
<br>
</body>

<script type="text/javascript">

  $(document).ready(function(){

     $('#Progress_Loading').hide();
  
    $(document).ajaxStart(function(){
      $('#Progress_Loading').show(); //ajax실행시 로딩바를 보여준다.
    })

    $(document).ajaxStop(function(){
      $('#Progress_Loading').hide(); //ajax종료시 로딩바를 숨겨준다.
    });
  });
  
  $('#btn_user').on('click', function(){
      var url= "/userPopup";    
      var winWidth = 1060;
      var winHeight = 620;
      var popupOption= "width="+winWidth+", height="+winHeight;
      var myWindow = window.open(url,"userPopup",popupOption);  
  });

  $('#delete_layer').on('click', function(e){

     var y = e.clientY;
     var x = e.clientX;
  })

  $(document).on('click' , 'span' , function(e){

    if($('#delete_layer').is(':visible')){
      $('#delete_layer').hide();
    }
    else{

      var top = e.clientY - 20;
      var left = e.clientX - 40;

      $('#delete_layer').css({ 
          "top"  : top ,
          "left" : left,
          "position" : "absolute"
      }).show();
    }

  })

  $(document).on('click','#SendMail',function(){
    //var pcode=$(this).attr('id'); //이거는 해당 element의 id value값을 가져오는것.
    var mailAddress = $(this).parents('span').parents('li')[0].childNodes[0].textContent;

    if(mailAddress.trim() != "" && 
       mailAddress.trim() != undefined && 
       mailAddress.trim() != 'undefined'){
        
      $.ajax({
         url: '/mailSend',
         type:'GET',
         data : { email : mailAddress},
         dataType: "json",  
         success : function(data) {

            if(data.result == 'ok'){
              alert("메일 전송이 성공하였습니다.");
            }else{
              alert("메일 전송이 실패하였습니다.");
            }
            //window.location.href = '/home/1';
          },
         error : function(error) {
            alert("메일 전송이 실패하였습니다.");
          }

      });

    }
    else{
      alert("메일주소를 확인하시기 바랍니다.");
    }
    
  });

</script>
</html>


